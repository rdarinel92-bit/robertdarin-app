{"query":"CREATE OR REPLACE FUNCTION public.trigger_send_chat_push_notification() RETURNS TRIGGER AS $body$ BEGIN IF NEW.emisor_tipo = 'cliente' THEN PERFORM net.http_post(url := 'https://qtfsxfvxqiihnofrpmmu.supabase.co/functions/v1/send-chat-push'::text, body := json_build_object('record', row_to_json(NEW))::jsonb, headers := jsonb_build_object('Content-Type', 'application/json', 'Authorization', 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF0ZnN4ZnZ4cWlpaG5vZnJwbW11Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjczMjU5MDIsImV4cCI6MjA4MjkwMTkwMn0.D4LrG8FlnqfK0Zhi2Ex0z2UGeoVSr6u1XR2jnxis9Bg')); END IF; RETURN NEW; END; $body$ LANGUAGE plpgsql SECURITY DEFINER;"}
